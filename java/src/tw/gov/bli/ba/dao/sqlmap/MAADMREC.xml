<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="MAADMREC">

    <typeAlias alias="Maadmrec" type="tw.gov.bli.ba.domain.Maadmrec" />
    
    <resultMap id="MAADMRECResult" class="Maadmrec">
        <result column="MAADMRECID"    property="maAdmRecId"      jdbcType="NUMERIC"      javaType="java.math.BigDecimal" />
        <result column="APNO"          property="apNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PRODATE"       property="proDate"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="LETTERTYPE"    property="letterType"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SEQNO"         property="seqNo"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="ISSUYM"        property="issuYm"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="IMK"           property="imk"             jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RPNO"          property="rpNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLRELATE"      property="slrelate"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNITNO"        property="unitNo"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="IDNO"          property="idNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NAME"          property="name"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="BRDATE"        property="brDate"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SUBNO"         property="subNo"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PRODEPNO"      property="proDepNo"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLRPNO"        property="slrpNo"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLDATE"        property="slDate"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNNO"          property="unNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNDES"         property="unDes"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CASETYP"       property="caseTyp"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NOTE"          property="note"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="DEALDESC"      property="dealDesc"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NDOMK1"        property="ndomk1"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NDOMK2"        property="ndomk2"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SECLVL"        property="seclvl"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SDDMK"         property="sddmk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PROMOTEUSER"   property="promoteUser"     jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SAVEYEAR"      property="saveYear"        jdbcType="NUMERIC"      javaType="java.math.BigDecimal" />
        <result column="DELMK"         property="delmk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SUPFLOWMK"     property="supflowMk"       jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CHGMK"         property="chgMk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UPADMMK"       property="upadmMk"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CHKMK"         property="chkMk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="BDMK"          property="bdMk"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="HURRYMK"       property="hurryMk"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RECHKMK"       property="rechkMk"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="FINISHDATE"    property="finishDate"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="ADDRMK"        property="addrMk"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="OWESYM"        property="owesYm"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="OWEEYM"        property="oweeYm"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PRTYP"         property="prTyp"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFCAUSE"   property="reliefCause"     jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFTYP"     property="reliefTyp"       jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFKIND"    property="reliefKind"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFSTAT"    property="reliefStat"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CLOSDATE"      property="closDate"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CLOSEMK"       property="closeMk"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CLOSENO"       property="closeNo"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="HPNO"          property="hpNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="INJSER"        property="injser"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="IDS"           property="ids"             jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SOURCE"        property="source"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="OMDATE"        property="omDate"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CRTUSER"       property="crtUser"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CRTTIME"       property="crtTime"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UPDUSER"       property="updUser"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UPDTIME"       property="updTime"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
    </resultMap>    
    
    <resultMap id="ExecutiveSupportQueryResult" class="Maadmrec">
        <result column="MAADMRECID"    property="maAdmRecId"      jdbcType="NUMERIC"      javaType="java.math.BigDecimal" />
        <result column="APNO"          property="apNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="ISSUYM"        property="issuYm"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PRODATE"       property="proDate"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="LETTERTYPE"    property="letterType"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SEQNO"         property="seqNo"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NDOMK1"        property="ndomk1"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>      
        <result column="NDOMK2"        property="ndomk2"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>       
        <result column="NOTE"          property="note"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CLOSDATE"      property="closDate"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="DELMK"         property="delMk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PROMOTEUSER"   property="promoteUser"     jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFKIND"    property="reliefKind"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFSTAT"    property="reliefStat"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFTYP"     property="reliefTyp"       jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLRPNO"        property="slrpNo"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLDATE"        property="slDate"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNNO"          property="unNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNDES"         property="unDes"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CASETYP"       property="caseTyp"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SDDMK"         property="sddMk"           jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="FINISHDATE"    property="finishDate"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SLRELATE"      property="slrelate"        jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="CLOSENO"       property="closeNo"         jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="HPNO"          property="hpNo"            jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="INJSER"        property="injser"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="UNITNO"        property="unitNo"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="SOURCE"        property="source"          jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
    </resultMap>   
    
    <!-- Extend for 行政支援查詢 -->
    <resultMap id="ExecutiveSupportQuery_AExtResult" class="Maadmrec" extends="ExecutiveSupportQueryResult">
        <!-- Columns from TABLE BAPARAM -->
        <result column="PARAMNAME"       property="paramName"       jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <!-- Columns from TABLE BAPANDOMK -->       
        <result column="NDOMKNAME1"      property="ndomkName1"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="NDOMKNAME2"      property="ndomkName2"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/> 
    </resultMap>   
    
    <!-- OldAgeReviewRpt 01 Begin -->
    <!-- [ -->
    <resultMap id="OldAgeReviewRpt01AnnuityPayDataDetailResult" class="Maadmrec">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
    </resultMap>
    <!-- ] -->
    <!-- OldAgeReviewRpt 01 End -->
    
    <resultMap id="LetterTypeMkResult" class="Maadmrec">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />    
    </resultMap>  
    
    <resultMap id="LetterTypeMk2Result" class="Maadmrec">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK2"         property="ndomk2"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />    
        <result column="NDOMKNAME1"     property="ndomkName1"   jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue=""/>
        <result column="NDOMKNAME2"     property="ndomkName2"   jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue=""/> 
    </resultMap>
    
    <resultMap id="LetterTypeMk6Result" class="Maadmrec">
        <result column="RELIEFCAUSE"   property="reliefCause"     jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFKIND"    property="reliefKind"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="RELIEFSTAT"    property="reliefStat"      jdbcType="VARCHAR"      javaType="java.lang.String" nullValue=""/>
        <result column="PRODATE"       property="proDate"         jdbcType="VARCHAR"      javaType="java.lang.String"   nullValue=""/>
    </resultMap>            
    
    <!-- SurvivorReviewRpt 01 Begin -->
    <!-- [ -->
    <resultMap id="SurvivorReviewRpt01AnnuityPayDataDetailResult" class="Maadmrec">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
    </resultMap>
    <!-- ] -->
    <!-- SurvivorReviewRpt 01 End -->
    
    <!-- BACO0D013Q Begin -->
    <!-- [ -->
    <resultMap id="SelectMaadmrecDataByResult" class="Maadmrec">
        <result column="SEQNO"          property="seqNo"        jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK2"         property="ndomk2"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
    </resultMap>
    <!-- ] -->
    <!-- BACO0D013Q End -->    
    
    <select id="selectExecutiveSupportQueryListBy" resultMap="ExecutiveSupportQuery_AExtResult">
      Select  A.MAADMRECID,
              A.APNO,
              A.ISSUYM,  
              A.PRODATE,  
              A.LETTERTYPE, 
              B.PARAMNAME, 
              A.SEQNO, 
              A.NDOMK1,  
              C.NDOMKNAME as NDOMKNAME1,
              A.NDOMK2, 
              NVL(D.NDOMKNAME,' ') as NDOMKNAME2,
              A.NOTE,
              A.CLOSDATE,
              A.DELMK,
              A.PROMOTEUSER,
              A.RELIEFKIND,
              A.RELIEFSTAT,
              A.RELIEFTYP,
              A.SLRPNO,
              A.SLDATE,
              A.UNNO,
              A.UNDES,
              A.CASETYP,
              A.SDDMK,
              A.FINISHDATE,
              A.SLRELATE,
              A.CLOSENO,
              A.HPNO,
              A.INJSER,
              A.UNITNO,
              A.SOURCE
        From  (Select  MAADMRECID,
                       APNO,
                       ISSUYM,
                       PRODATE,
                       LETTERTYPE,
                       SEQNO,
                       NDOMK1,
                       NDOMK2,
                       NOTE,
                       CLOSDATE,
                       DELMK,
                       PROMOTEUSER,
                       RELIEFKIND,
                       RELIEFSTAT,
                       RELIEFTYP,
                       SLRPNO,
                       SLDATE,
                       UNNO,
                       UNDES,
                       CASETYP,
                       SDDMK,
                       FINISHDATE,
                       SLRELATE,
                       CLOSENO,
                       HPNO,
                       INJSER,
                       UNITNO,
                       SOURCE
                 From  MAADMREC              
                Where  APNO   = #apNo:VARCHAR#
           <isNotEmpty prepend="AND" property="issuYm">
             ISSUYM = #issuYm:VARCHAR#
           </isNotEmpty>
           <isNotEmpty prepend="AND" property="idNo">
             IDNO = #idNo:VARCHAR#
           </isNotEmpty>
           
        ) A, BAPARAM  B, BAPANDOMK  C, BAPANDOMK  D
      Where  A.LETTERTYPE = B.PARAMCODE
        AND (A.LETTERTYPE = C.LETTERTYPE(+))
        AND (A.LETTERTYPE = D.LETTERTYPE(+))  
        AND A.NDOMK1 = C.NDOMK(+)
        AND A.NDOMK2 = D.NDOMK(+)
        AND B.PARAMGROUP = 'LETTERTYPE'
        AND B.PARAMTYP = '1'
        AND C.SYSID(+)='BA'
        AND D.SYSID(+)='BA' 
        AND B.PARAMUSEMK = 'Y' ORDER BY A.PRODATE
    </select>
    
    <select id="selectExecutiveSupportCloseListBy" resultMap="ExecutiveSupportQuery_AExtResult">
      Select  A.MAADMRECID,
              A.APNO,
              A.ISSUYM,  
              A.PRODATE,  
              A.LETTERTYPE, 
              B.PARAMNAME, 
              A.SEQNO, 
              A.NDOMK1,  
              C.NDOMKNAME as NDOMKNAME1,
              A.NDOMK2, 
              D.NDOMKNAME as NDOMKNAME2,
              A.NOTE,
              A.CLOSDATE,
              A.DELMK,
              A.PROMOTEUSER,
              A.RELIEFKIND,
              A.RELIEFSTAT,
              A.RELIEFTYP,
              A.SLRPNO,
              A.SLDATE,
              A.UNNO,
              A.UNDES,
              A.CASETYP,
              A.SDDMK,
              A.FINISHDATE,
              A.SLRELATE,
              A.CLOSENO,
              A.HPNO,
              A.INJSER,
              A.UNITNO,
              A.SOURCE
      From  (Select  MAADMRECID,
                     APNO,
                     ISSUYM,
                     PRODATE,
                     LETTERTYPE,
                     SEQNO,
                     NDOMK1,
                     NDOMK2,
                     NOTE,
                     CLOSDATE,
                     DELMK,
                     PROMOTEUSER,
                     RELIEFKIND,
                     RELIEFSTAT,
                     RELIEFTYP,
                     SLRPNO,
                     SLDATE,
                     UNNO,
                     UNDES,
                     CASETYP,
                     SDDMK,
                     FINISHDATE,
                     SLRELATE,
                     CLOSENO,
                     HPNO,
                     INJSER,
                     UNITNO,
                     SOURCE
               From  MAADMREC              
              Where  APNO   = #apNo:VARCHAR#
           <isNotEmpty prepend="AND" property="issuYm">
           <![CDATA[
             ISSUYM <= #issuYm:VARCHAR#
             ]]> 
           </isNotEmpty>
           <isNotEmpty prepend="AND" property="proDate">
             PRODATE = #proDate:VARCHAR#
           </isNotEmpty>
           <isNotEmpty prepend="AND" property="seqNo">
             SEQNO = #seqNo:VARCHAR#
           </isNotEmpty>
           <isNotEmpty prepend="AND" property="letterType">
             LETTERTYPE = #letterType:VARCHAR#
           </isNotEmpty>
        ) A,  BAPARAM  B, 
            BAPANDOMK  C,  BAPANDOMK  D
      <![CDATA[
      Where  A.LETTERTYPE  =  B.PARAMCODE
             And  B.PARAMCODE  =  C.LETTERTYPE
             And  (A.LETTERTYPE  =  D.LETTERTYPE
                    Or D.LETTERTYPE is NULL)  
             And  A.NDOMK1     =  C.NDOMK
             And  A.NDOMK2     =  D.NDOMK (+)
             And  B.PARAMGROUP =  'LETTERTYPE'
             And  B.PARAMTYP    =  '1'
             And  B.PARAMUSEMK =  'Y'
             AND  C.SYSID='BA'
             AND  D.SYSID(+)='BA'  
     ]]> 
        <!-- And  A.LETTERTYPE  <>  '21' -->
       <![CDATA[
             And  trim(A.CLOSDATE) is null ORDER BY A.PRODATE
       ]]>    
    </select>
    
    <select id="selectSeqNoBy" resultClass="java.lang.String">
        Select  LPAD(TO_NUMBER(NVL(MAX(TO_NUMBER(SEQNO)),0))+1,2,'0') AS SEQNO     
          From  MAADMREC
         Where  APNO     = #apNo:VARCHAR#
           And  ISSUYM     = #issuYm:VARCHAR#
           And  LETTERTYPE = #letterType:VARCHAR#
           And  PRODATE    = #proDate:VARCHAR# 
    </select>
    
    <insert id="insertData" >
        <selectKey resultClass="java.math.BigDecimal" keyProperty="maAdmRecId">
            SELECT MAADMRECID.NEXTVAL AS MAADMRECID FROM DUAL
        </selectKey>
        INSERT INTO MAADMREC
        ( 
            MAADMRECID,
            APNO,        
            PRODATE,     
            LETTERTYPE,  
            SEQNO,       
            ISSUYM,      
            RPNO,        
            SLRELATE,    
            UNITNO,      
            IDNO,        
            NAME,        
            BRDATE,      
            SUBNO,       
            PRODEPNO,    
            SLRPNO,      
            SLDATE,      
            UNNO,        
            UNDES,       
            CASETYP,     
            NOTE,              
            DEALDESC,    
            NDOMK1,      
            NDOMK2,      
            SECLVL,      
            SDDMK,       
            PROMOTEUSER, 
            SAVEYEAR,    
            DELMK,       
            SUPFLOWMK,   
            CHGMK,       
            UPADMMK,     
            CHKMK,       
            BDMK,        
            HURRYMK,     
            RECHKMK,           
            FINISHDATE,  
            ADDRMK,      
            OWESYM,
            OWEEYM,      
            PRTYP,       
            RELIEFCAUSE, 
            RELIEFTYP,
            RELIEFKIND,
            RELIEFSTAT,   
            CLOSDATE,    
            CLOSEMK,     
            CLOSENO,
            HPNO,
            INJSER,
            IDS,
            SOURCE,
            OMDATE,     
            CRTUSER,     
            CRTTIME,     
            UPDUSER,     
            UPDTIME,
            IMK
        )
        values
        (
            #maAdmRecId#,
            #apNo:VARCHAR#,
            #proDate:VARCHAR#,      
            #letterType:VARCHAR#,   
            #seqNo:VARCHAR#,        
            #issuYm:VARCHAR#,       
            #rpNo:VARCHAR#,         
            #slrelate:VARCHAR#,     
            #unitNo:VARCHAR#,       
            #idNo:VARCHAR#,         
            #name:VARCHAR#,         
            #brDate:VARCHAR#,       
            #subNo:VARCHAR#,        
            #proDepNo:VARCHAR#,     
            #slrpNo:VARCHAR#,       
            #slDate:VARCHAR#,       
            #unNo:VARCHAR#,         
            #unDes:VARCHAR#,        
            #caseTyp:VARCHAR#,      
            #note:VARCHAR#,                
            #dealDesc:VARCHAR#,     
            #ndomk1:VARCHAR#,       
            #ndomk2:VARCHAR#,       
            #seclvl:VARCHAR#,       
            #sddMk:VARCHAR#,        
            #promoteUser:VARCHAR#,  
            #saveYear:NUMERIC#,     
            #delMk:VARCHAR#,        
            #supflowMk:VARCHAR#,    
            #chgMk:VARCHAR#,        
            #upadmMk:VARCHAR#,      
            #chkMk:VARCHAR#,        
            #bdMk:VARCHAR#,         
            #hurryMk:VARCHAR#,      
            #rechkMk:VARCHAR#,            
            #finishDate:VARCHAR#,   
            #addrMk:VARCHAR#,       
            #owesYm:VARCHAR#,
            #oweeYm:VARCHAR#,       
            #prTyp:VARCHAR#,        
            #reliefCause:VARCHAR#,  
            #reliefTyp:VARCHAR#,
            #reliefKind:VARCHAR#,
            #reliefStat:VARCHAR#,    
            #closDate:VARCHAR#,     
            #closeMk:VARCHAR#,      
            #closeNo:VARCHAR#,
            #hpNo:VARCHAR#,
            #injser:VARCHAR#, 
            #ids:VARCHAR#,
            #source:VARCHAR#,
            #omDate:VARCHAR#,     
            #crtUser:VARCHAR#,      
            #crtTime:VARCHAR#,     
            #updUser:VARCHAR#,      
            #updTime:VARCHAR#,
            #imk:VARCKAR#     
        )  
    </insert>

    <update id="updateData">
        update MAADMREC 
           set LETTERTYPE  =  #letterType:VARCHAR#,
               PRODATE     =  #proDate:VARCHAR#,
               PROMOTEUSER = #promoteUser:VARCHAR#,
               NDOMK1      =  #ndomk1:VARCHAR#,
               NDOMK2      =  #ndomk2:VARCHAR#,
               RELIEFKIND =  #reliefKind:VARCHAR#,
               RELIEFSTAT =  #reliefStat:VARCHAR#,
               RELIEFTYP  =  #reliefTyp:VARCHAR#,
               SLRPNO     =  #slrpNo:VARCHAR#,      
               SLDATE     =  #slDate:VARCHAR#,      
               UNNO       =  #unNo:VARCHAR#,        
               UNDES      =  #unDes:VARCHAR#,
               NOTE        =  #note:VARCHAR#,
               CASETYP     =  #caseTyp:VARCHAR#,
               SDDMK       = #sddMk:VARCHAR#,
               DELMK       =  #delMk:VARCHAR#,
               FINISHDATE  =  #finishDate:VARCHAR#,
               SLRELATE    =  #slrelate:VARCHAR#,
               CLOSENO     =  #closeNo:VARCHAR#,
               CLOSDATE    =  #closDate:VARCHAR#,
               HPNO        =  #hpNo:VARCHAR#,
               INJSER      =  #injser:VARCHAR#,
               UNITNO      =  #unitNo:VARCHAR#,
               UPDUSER     =  #updUser:VARCHAR#,
               UPDTIME     =  #updTime:VARCHAR#
         Where MAADMRECID  =  #maAdmRecId:VARCHAR#
    </update>
    
    <update id="updateDataClosedate">
        update MAADMREC 
           set CLOSDATE     =  #closDate:VARCHAR#,
               UPDUSER      =  #updUser:VARCHAR#,
               UPDTIME      =  #updTime:VARCHAR#
         Where APNO      =  #apNo:VARCHAR#
           And PRODATE   =  #proDate:VARCHAR#
           And ISSUYM    =  #issuYm:VARCHAR#
           And SEQNO     =  #seqNo:VARCHAR#
           And LETTERTYPE  =  #letterType:VARCHAR#  
    </update>
    
    
    <delete id="deleteData">
        Delete MAADMREC  
         Where APNO       = #apNo:VARCHAR#
           And PRODATE    = #proDate:VARCHAR#
           And LETTERTYPE = #letterType:VARCHAR#
           And SEQNO      = #seqNo:VARCHAR#
    </delete>
    
    <select id="selectLetterTypeMk1" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE = '16'
                   AND B.LPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE = '16' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
         ]]>  
    </select>
    
    <select id="selectLetterTypeMk2" resultMap="LetterTypeMk2Result">
        <![CDATA[
        SELECT DISTINCT
               NDOMK1
              ,NDOMK2
              ,PRODATE
              ,NDOMKNAME1
              ,NDOMKNAME2
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#  
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMKNAME1,
                       (A.NDOMK2||'-'||C.NDOMKNAME) NDOMKNAME2,
                       A.NDOMK1 NDOMK1,
                       A.NDOMK2 NDOMK2,
                       A.PRODATE
                  FROM MAADMREC A ,BAPANDOMK B,BAPANDOMK C
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND C.SYSID(+)='BA'
                   AND A.LETTERTYPE = C.LETTERTYPE(+)
                   AND A.APNO = #apNo:VARCHAR#  
                   AND A.NDOMK1 = B.NDOMK
                   AND A.NDOMK2 = C.NDOMK(+)
                   AND A.LETTERTYPE = '21'
                   AND B.LPAYMK = '1'
                   AND C.LPAYMK (+)= '1'
                   AND nvl(trim(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE = '21' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2                                                                   
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE 
        ]]>
    </select>

    <select id="selectLetterTypeMk3" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||DECODE(A.LETTERTYPE,'11',(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))),
                                                                                   (DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strC:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strD:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('11','12')
                   AND B.LPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('11','12') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE         
        ]]>
    </select>

    <select id="selectLetterTypeMk4" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('14','15','19')
                   AND B.LPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('14','15','19') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO 
         ORDER BY PRODATE  
        ]]>
    </select>
    
    <select id="selectLetterTypeMk5" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('17','22','23','24','30','31','40')
                   AND B.LPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE IN ('17','22','23','24','30','31','40') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
        ]]>
    </select>
    
    <select id="selectLetterTypeMk6" resultMap="LetterTypeMk6Result">
        <![CDATA[
        SELECT DISTINCT
               RELIEFCAUSE,                                     
               RELIEFKIND,                                      
               RELIEFSTAT,                                      
               PRODATE                                          
        FROM (SELECT APNO,
                 ISSUYM
            FROM BAAPPBASE  
           WHERE APNO = #apNo:VARCHAR# 
            AND SEQNO = '0000') T1
        ,(SELECT A.APNO,
                 A.ISSUYM,
                 B.NDOMKNAME AS RELIEFCAUSE,                                    
                 A.RELIEFKIND,                                      
                 A.RELIEFSTAT,                                      
                 A.PRODATE                                              
            FROM MAADMREC A ,BAPANDOMK B 
           WHERE A.LETTERTYPE = B.LETTERTYPE
             AND B.SYSID='BA'
             AND A.APNO = #apNo:VARCHAR# 
             AND A.NDOMK1 = B.NDOMK
             AND A.LETTERTYPE='31'
             AND B.LPAYMK = '1'
             AND nvl(trim(A.DELMK),' ') <> 'D'
             AND A.PRODATE = (SELECT MAX(PRODATE)
                                FROM MAADMREC
                               WHERE APNO = #apNo:VARCHAR# 
                                 AND LETTERTYPE='31' 
                                 AND LETTERTYPE = A.LETTERTYPE 
                                 AND nvl(trim(DELMK),' ') <> 'D')) T2 
        WHERE T1.APNO = T2.APNO
        ORDER BY PRODATE
        ]]>
    </select>
    
    <select id="selectLetterTypeMk1K" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE = '16'
                   AND B.KPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE = '16' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
         ]]>  
    </select>
    
    <select id="selectLetterTypeMk2K" resultMap="LetterTypeMk2Result">
        <![CDATA[
        SELECT DISTINCT
               NDOMK1
              ,NDOMK2
              ,PRODATE
              ,NDOMKNAME1
              ,NDOMKNAME2
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#  
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMKNAME1,
                       (A.NDOMK2||'-'||C.NDOMKNAME) NDOMKNAME2,
                       A.NDOMK1 NDOMK1,
                       A.NDOMK2 NDOMK2,
                       A.PRODATE
                  FROM MAADMREC A ,BAPANDOMK B,BAPANDOMK C
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND C.SYSID(+)='BA'
                   AND A.LETTERTYPE = C.LETTERTYPE(+)
                   AND A.APNO = #apNo:VARCHAR#  
                   AND A.NDOMK1 = B.NDOMK
                   AND A.NDOMK2 = C.NDOMK(+)
                   AND A.LETTERTYPE = '21'
                   AND B.KPAYMK = '1'
                   AND C.KPAYMK (+)= '1'
                   AND nvl(trim(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE = '21' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2                                                                   
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE 
        ]]>
    </select>

    <select id="selectLetterTypeMk3K" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||DECODE(A.LETTERTYPE,'11',(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))),
                                                                                   (DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strC:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strD:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('11','12')
                   AND B.KPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('11','12') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE         
        ]]>
    </select>

    <select id="selectLetterTypeMk4K" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('14','15','19')
                   AND B.KPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('14','15','19') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO 
         ORDER BY PRODATE  
        ]]>
    </select>
    
    <select id="selectLetterTypeMk5K" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('17','22','23','24','30','31','40')
                   AND B.KPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE IN ('17','22','23','24','30','31','40') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
        ]]>
    </select>
    
    <select id="selectLetterTypeMk6K" resultMap="LetterTypeMk6Result">
        <![CDATA[
        SELECT DISTINCT
               RELIEFCAUSE,                                     
               RELIEFKIND,                                      
               RELIEFSTAT,                                      
               PRODATE                                          
        FROM (SELECT APNO,
                 ISSUYM
            FROM BAAPPBASE  
           WHERE APNO = #apNo:VARCHAR# 
            AND SEQNO = '0000') T1
        ,(SELECT A.APNO,
                 A.ISSUYM,
                 B.NDOMKNAME AS RELIEFCAUSE,                                    
                 A.RELIEFKIND,                                      
                 A.RELIEFSTAT,                                      
                 A.PRODATE                                              
            FROM MAADMREC A ,BAPANDOMK B 
           WHERE A.LETTERTYPE = B.LETTERTYPE
             AND B.SYSID='BA'
             AND A.APNO = #apNo:VARCHAR# 
             AND A.NDOMK1 = B.NDOMK
             AND A.LETTERTYPE='31'
             AND B.KPAYMK = '1'
             AND nvl(trim(A.DELMK),' ') <> 'D'
             AND A.PRODATE = (SELECT MAX(PRODATE)
                                FROM MAADMREC
                               WHERE APNO = #apNo:VARCHAR# 
                                 AND LETTERTYPE='31' 
                                 AND LETTERTYPE = A.LETTERTYPE 
                                 AND nvl(trim(DELMK),' ') <> 'D')) T2 
        WHERE T1.APNO = T2.APNO
        ORDER BY PRODATE
        ]]>
    </select>
    
    <select id="selectLetterTypeMk1S" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE = '16'
                   AND B.SPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE = '16' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
         ]]>  
    </select>
    
    <select id="selectLetterTypeMk2S" resultMap="LetterTypeMk2Result">
        <![CDATA[
        SELECT DISTINCT
               NDOMK1
              ,NDOMK2
              ,PRODATE
              ,NDOMKNAME1
              ,NDOMKNAME2
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#  
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.NDOMK1||'-'||B.NDOMKNAME) NDOMKNAME1,
                       (A.NDOMK2||'-'||C.NDOMKNAME) NDOMKNAME2,
                       A.NDOMK1 NDOMK1,
                       A.NDOMK2 NDOMK2,
                       A.PRODATE
                  FROM MAADMREC A ,BAPANDOMK B,BAPANDOMK C
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND C.SYSID(+)='BA'
                   AND A.LETTERTYPE = C.LETTERTYPE(+)
                   AND A.APNO = #apNo:VARCHAR#  
                   AND A.NDOMK1 = B.NDOMK
                   AND A.NDOMK2 = C.NDOMK(+)
                   AND A.LETTERTYPE = '21'
                   AND B.SPAYMK = '1'
                   AND C.SPAYMK (+)= '1'
                   AND nvl(trim(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE = '21' 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2                                                                   
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE 
        ]]>
    </select>

    <select id="selectLetterTypeMk3S" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||DECODE(A.LETTERTYPE,'11',(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))),
                                                                                   (DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strC:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strD:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8))))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('11','12')
                   AND B.SPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('11','12') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE         
        ]]>
    </select>

    <select id="selectLetterTypeMk4S" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(DECODE(NVL(TRIM(A.CLOSDATE),'P'),'P',(#strA:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))),(#strB:VARCHAR#||(LPAD(TO_CHAR((SUBSTR(A.CLOSDATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.CLOSDATE, 5 ,8)))))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('14','15','19')
                   AND B.SPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR#
                                       AND LETTERTYPE IN ('14','15','19') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO 
         ORDER BY PRODATE  
        ]]>
    </select>
    
    <select id="selectLetterTypeMk5S" resultMap="LetterTypeMkResult">
        <![CDATA[
        SELECT DISTINCT
               T2.PRODATE
              ,T2.NDOMK1
          FROM (SELECT APNO,
                       ISSUYM
                  FROM BAAPPBASE  
                 WHERE APNO = #apNo:VARCHAR#
                   AND SEQNO = '0000') T1
              ,(SELECT A.APNO,
                       A.ISSUYM,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||B.NDOMKNAME) NDOMK1,
                       (A.LETTERTYPE||'-'||A.NDOMK1||'-'||(LPAD(TO_CHAR((SUBSTR(A.PRODATE, 0 ,4))-1911), 3, '0')||SUBSTR(A.PRODATE, 5 ,8))) PRODATE
                  FROM MAADMREC A ,BAPANDOMK B 
                 WHERE A.LETTERTYPE = B.LETTERTYPE
                   AND B.SYSID='BA'
                   AND A.APNO = #apNo:VARCHAR#
                   AND A.NDOMK1 = B.NDOMK
                   AND A.LETTERTYPE IN ('17','22','23','24','30','31','40')
                   AND B.SPAYMK = '1'
                   AND NVL(TRIM(A.DELMK),' ') <> 'D'
                   AND A.PRODATE = (SELECT MAX(PRODATE)
                                      FROM MAADMREC
                                     WHERE APNO = #apNo:VARCHAR# 
                                       AND LETTERTYPE IN ('17','22','23','24','30','31','40') 
                                       AND LETTERTYPE = A.LETTERTYPE 
                                       AND nvl(trim(DELMK),' ') <> 'D')) T2
         WHERE T1.APNO = T2.APNO
         ORDER BY PRODATE
        ]]>
    </select>
    
    <select id="selectLetterTypeMk6S" resultMap="LetterTypeMk6Result">
        <![CDATA[
        SELECT DISTINCT
               RELIEFCAUSE,                                     
               RELIEFKIND,                                      
               RELIEFSTAT,                                      
               PRODATE                                          
        FROM (SELECT APNO,
                 ISSUYM
            FROM BAAPPBASE  
           WHERE APNO = #apNo:VARCHAR# 
            AND SEQNO = '0000') T1
        ,(SELECT A.APNO,
                 A.ISSUYM,
                 B.NDOMKNAME AS RELIEFCAUSE,                                    
                 A.RELIEFKIND,                                      
                 A.RELIEFSTAT,                                      
                 A.PRODATE                                              
            FROM MAADMREC A ,BAPANDOMK B 
           WHERE A.LETTERTYPE = B.LETTERTYPE
             AND B.SYSID='BA'
             AND A.APNO = #apNo:VARCHAR# 
             AND A.NDOMK1 = B.NDOMK
             AND A.LETTERTYPE='31'
             AND B.SPAYMK = '1'
             AND nvl(trim(A.DELMK),' ') <> 'D'
             AND A.PRODATE = (SELECT MAX(PRODATE)
                                FROM MAADMREC
                               WHERE APNO = #apNo:VARCHAR# 
                                 AND LETTERTYPE='31' 
                                 AND LETTERTYPE = A.LETTERTYPE 
                                 AND nvl(trim(DELMK),' ') <> 'D')) T2 
        WHERE T1.APNO = T2.APNO
        ORDER BY PRODATE
        ]]>
    </select>        
    
    <select id="selectLetterTypeMk6Kind" resultClass="java.lang.String">  
        <![CDATA[   
        SELECT PARAMNAME                     
            FROM BAPARAM
        WHERE PARAMGROUP = 'RELIEFKIND'
            AND PARAMCODE = #reliefKind:VARCHAR#
         ]]>
    </select>
    
    <select id="selectLetterTypeMk6Stat" resultClass="java.lang.String">
       <![CDATA[       
        SELECT PARAMNAME                     
            FROM BAPARAM
        WHERE PARAMGROUP = ('RELIEFKIND'||#reliefKind:VARCHAR#)
            AND PARAMCODE = #reliefStat:VARCHAR#
        ]]>
    </select>
    
    <!-- OldAgeReviewRpt 01 Begin -->
    <!-- [ -->
    <select id="getOldAgeReviewRpt01AnnuityPayDataBy" resultMap="OldAgeReviewRpt01AnnuityPayDataDetailResult">
        SELECT A.PRODATE,
               A.NDOMK1
        FROM   MAADMREC A  
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    A.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="issuYm">
                    A.ISSUYM = #issuYm:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND A.LETTERTYPE = '11'
                AND A.CRTTIME = ( SELECT MAX(B.CRTTIME) FROM MAADMREC B
                                   WHERE B.APNO = A.APNO
                                     AND B.ISSUYM = A.ISSUYM
                                     AND B.LETTERTYPE = '11' 
                                 )
                ]]>
            </isParameterPresent>
        </dynamic>
    </select>
    <!-- ] -->
    <!-- OldAgeReviewRpt 01 End -->  
    
    <select id="selectQ1ForReview" resultClass="java.lang.Integer">
       <![CDATA[       
       SELECT COUNT(*) AS Q1
         FROM MAADMREC T 
        WHERE T.APNO = #apNo:VARCHAR#
          AND T.ISSUYM <= #issuYm:VARCHAR#
          AND T.LETTERTYPE = '21'
          AND NVL(TRIM(T.DELMK),' ') <> 'D'
        ]]>
    </select>
    
    <select id="selectQ2ForReview" resultClass="java.lang.Integer">
		<![CDATA[       
        SELECT COUNT(*) AS Q2
          FROM MAADMREC T 
         WHERE T.APNO = #apNo:VARCHAR#
		   AND T.ISSUYM <= #issuYm:VARCHAR#
		   AND T.LETTERTYPE IN ('11','12','14','15','16','17','19')
		   AND NVL(TRIM(T.DELMK),' ') <> 'D'
		   AND NVL(TRIM(T.CLOSDATE),' ') = ' '
        ]]>
    </select>
    
    <!-- SurvivorReviewRpt 01 Begin -->
    <!-- [ -->
    <select id="selectSurvivorReviewRpt01AnnuityPayDataBy" resultMap="SurvivorReviewRpt01AnnuityPayDataDetailResult">
        SELECT PRODATE, NDOMK1
          FROM (SELECT A.PRODATE,
                       A.NDOMK1
                  FROM MAADMREC A  
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    A.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="issuYm">
                    A.ISSUYM = #issuYm:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND A.LETTERTYPE = '11'
                AND A.CRTTIME = ( SELECT MAX(B.CRTTIME) FROM MAADMREC B
                                   WHERE B.APNO = A.APNO
                                     AND B.ISSUYM = A.ISSUYM
                                     AND B.LETTERTYPE = '11' 
                                 ) 
                ]]>
            </isParameterPresent>
        </dynamic>
               )
    </select>
    <!-- ] -->
    <!-- SurvivorReviewRpt 01 End -->
    
    <!-- DisableReviewRpt 01 Begin -->
    
    <select id="getDisableReviewRpt01AnnuityPayDataBy" resultMap="OldAgeReviewRpt01AnnuityPayDataDetailResult">
        SELECT A.PRODATE,
               A.NDOMK1
        FROM   MAADMREC A  
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    A.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="issuYm">
                    A.ISSUYM = #issuYm:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND A.LETTERTYPE = '11'
                AND A.CRTTIME = ( SELECT MAX(B.CRTTIME) FROM MAADMREC B
                                   WHERE B.APNO = A.APNO
                                     AND B.ISSUYM = A.ISSUYM
                                     AND B.LETTERTYPE = '11' 
                                 )
                ]]>
            </isParameterPresent>
        </dynamic>
    </select>
    
    <!-- DisableReviewRpt 01 End -->
    
    <!-- BACO0D013Q Begin -->
    <!-- [ -->
    <select id="selectMaadmrecDataBy" resultMap="SelectMaadmrecDataByResult">
        SELECT '1' as SEQNO, 
               to_char(count(t.ndomk1)) as NDOMK1, 
               to_char(count(t.ndomk2)) as NDOMK2
        FROM   MAADMREC t 
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    t.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND t.LETTERTYPE = '21'
   				and (t.delmk <> 'D' or t.delmk is NULL)
                ]]>
            </isParameterPresent>
        </dynamic>
        UNION
        SELECT '2' as SEQNO, 
               to_char(count(t.ndomk1)) as NDOMK1, 
               to_char(count(t.ndomk2)) as NDOMK2
        FROM   MAADMREC t 
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    t.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND t.LETTERTYPE = '21'
   				and (trim(t.ndomk1) <> '02' or trim(t.ndomk2) <> '02')
   				and (t.delmk <> 'D' or t.delmk is NULL)
                ]]>
            </isParameterPresent>
        </dynamic>
        UNION
        SELECT '3' as SEQNO, 
               to_char(count(t.ndomk1)) as NDOMK1, 
               to_char(count(t.ndomk2)) as NDOMK2
        FROM   MAADMREC t 
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    t.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <![CDATA[
				and t.lettertype = '21'
                and (trim(t.ndomk1) = '02' or trim(t.ndomk2) = '02')
                and (t.delmk <> 'D' or t.delmk is NULL)
                ]]>
            </isParameterPresent>
        </dynamic>                        
    </select>
    <!-- ] -->
    <!-- BACO0D013Q End -->

	<insert id="insertDataForMonthlyRpt31">
		<selectKey resultClass="java.math.BigDecimal" keyProperty="maAdmRecId">
			SELECT MAADMRECID.NEXTVAL AS MAADMRECID FROM DUAL
		</selectKey>
		insert into MAADMREC
		( MAADMRECID,
		  APNO,
		  PRODATE,
		  LETTERTYPE,
		  SEQNO,
		  ISSUYM,
		  IDNO,
		  NAME,
		  BRDATE,
		  NDOMK1,
		  PROMOTEUSER,
		  CRTUSER,
		  CRTTIME
		)
		values
		(
		  #maAdmRecId#,
		  #apNo:VARCHAR#,
		  #proDate:VARCHAR#,
		  #letterType:VARCHAR#,
		  #seqNo:VARCHAR#,
		  #issuYm:VARCHAR#,
		  #idNo:VARCHAR#,
		  #name:VARCHAR#,
		  #brDate:VARCHAR#,
		  #ndomk1:NUMERIC#,
		  #promoteUser:VARCHAR#,
		  #crtUser:VARCHAR#,
		  #crtTime:VARCHAR#
		)
	</insert>

	<select id="selectMaAdmRecIdForMonthlyRpt31" resultClass="java.math.BigDecimal">
		Select MAADMRECID
		  From MAADMREC
		 Where APNO = #apNo:VARCHAR#
		   And SEQNO = #seqNo:VARCHAR#
		   And ISSUYM = #issuYm:VARCHAR#
		   And LETTERTYPE = #letterType:VARCHAR#
		   And PRODATE = #proDate:VARCHAR#
	</select>

	<update id="updateCloseDateForMonthlyRpt31">
		update MAADMREC
		   set CLOSDATE = #closDate:VARCHAR#,
		       UPDUSER = #updUser:VARCHAR#,
		       UPDTIME = #updTime:VARCHAR#
		 Where MAADMRECID = #maAdmRecId:NUMERIC#
		   And APNO = #apNo:VARCHAR#
		   And LETTERTYPE = #letterType:VARCHAR#
	</update>

    <update id="updateDataForCloseStatusAlteration">
        UPDATE MAADMREC M
           SET M.DELMK = 'D',
               M.UPDUSER = #updUser:VARCHAR#,
               M.UPDTIME = TO_CHAR(SYSDATE,'YYYYMMDDHH24MMSS')
        WHERE M.APNO = #apNo:VARCHAR#       
          AND M.LETTERTYPE = '21'
          AND M.APNO IN (SELECT T.APNO 
                           FROM BAAPPBASE T
                          WHERE T.APNO = #apNo:VARCHAR#    
                            AND T.CASETYP = '3')
    </update>
</sqlMap>