<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="BXADMINS">

    <typeAlias alias="Bxadmins" type="tw.gov.bli.ba.domain.Bxadmins" />
    
    <resultMap id="OldAgeReviewRpt01AnnuityPayDataDetailResult" class="Bxadmins">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
    </resultMap>
    <resultMap id="SurvivorReviewRpt01AnnuityPayDataDetailResult" class="Bxadmins">
        <result column="PRODATE"        property="proDate"      jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
        <result column="NDOMK1"         property="ndomk1"       jdbcType="VARCHAR"      javaType="java.lang.String"     nullValue="" />
    </resultMap>

    <select id="selectSurvivorReviewRpt01AnnuityPayDataBy" resultMap="SurvivorReviewRpt01AnnuityPayDataDetailResult">
        SELECT PRODATE, NDOMK1
          FROM (SELECT A.PRODATE,
                       A.NDOMK1
                  FROM BXADMINS A  
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    A.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="issuYm">
                    A.ISSUYM = #issuYm:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND A.LETTERTYPE = '11'
                AND A.CRTTIME = ( SELECT MAX(B.CRTTIME) FROM BXADMINS B
                                   WHERE B.APNO = A.APNO
                                     AND B.ISSUYM = A.ISSUYM
                                     AND B.LETTERTYPE = '11' 
                                 ) 
                ]]>
            </isParameterPresent>
        </dynamic>
               )
    </select>

    <select id="getDisableReviewRpt01AnnuityPayDataBy" resultMap="OldAgeReviewRpt01AnnuityPayDataDetailResult">
        SELECT A.PRODATE,
               A.NDOMK1
        FROM   BXADMINS A  
        <dynamic prepend="WHERE">
            <isNotParameterPresent>
                1 = 0
            </isNotParameterPresent>
            <isParameterPresent>
                <isNotEmpty prepend="AND" property="apNo">
                    A.APNO = #apNo:VARCHAR#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="issuYm">
                    A.ISSUYM = #issuYm:VARCHAR#
                </isNotEmpty>
                <![CDATA[
                AND A.LETTERTYPE = '11'
                AND A.CRTTIME = ( SELECT MAX(B.CRTTIME) FROM BXADMINS B
                                   WHERE B.APNO = A.APNO
                                     AND B.ISSUYM = A.ISSUYM
                                     AND B.LETTERTYPE = '11' 
                                 )
                ]]>
            </isParameterPresent>
        </dynamic>
    </select>
    
</sqlMap>